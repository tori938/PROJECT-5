## **Проект 5. Предсказание продолжительности поездки на такси в Нью-Йорке**

## Оглавление
1. [Описание Проекта](README.md#описание-проекта)
2. [Основные Задачи](README.md#основные-задачи)
3. [Краткая Информация о Данных](README.md#краткая-информация-о-данных)
4. [Этапы Работы над Проектом](README.md#этапы-работы-над-проектом)
5. [Результат](README.md#результат)


### Описание Проекта

[Соревнование](https://www.kaggle.com/competitions/nyc-taxi-trip-duration) и все данные выложены на Kaggle.
Представьте, что вы заказываете такси из одной точки Нью-Йорка в другую, причём необязательно, что конечная точка должна находиться в пределах города. Сколько вы должны будете заплатить за поездку?

Известно, что стоимость такси в США рассчитывается на основе фиксированной ставки и тарифной стоимости, величина которой зависит от времени и расстояния. Тарифы варьируются в зависимости от города.

В свою очередь, время поездки зависит от множества факторов, таких как направление поездки, время суток, погодные условия и так далее.

Таким образом, если мы разработаем алгоритм, способный определять длительность поездки, мы сможем прогнозировать её стоимость самым тривиальным образом, например, просто умножая стоимость на заданный тариф.

:arrow_up:[to Table of Contents](README.md#оглавление)


### Основные Задачи

*Бизнес-задача*: определить характеристики и с их помощью спрогнозировать длительность поездки на такси.

*Техническая задача*: построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать числовой признак — время поездки такси, то есть решить задачу регрессии.

_Основные Задачи_:

- Сформировать набор данных на основе нескольких источников информации;
- Спроектировать новые признаки с помощью Feature Engineering и выявить наиболее значимые при построении модели;
- Исследовать предоставленные данные и выявить закономерности;
- Построить несколько моделей и выбрать из них наилучшую по заданной метрике;
- Спроектировать процесс предсказания времени длительности поездки для новых данных

:arrow_up:[to Table of Contents](README.md#оглавление)


### Краткая Информация о Данных

train.csv содержит датасет тренировочных + валидационных данных, 1.5 млн строк и 11 полей со следующей информацией:

    Данные о клиенте и таксопарке:
        id — уникальный идентификатор поездки;
        vendor_id — уникальный идентификатор поставщика услуг (таксопарка), связанного с записью поездки.

    Временные характеристики:
        pickup_datetime — дата и время, когда был включён счётчик поездки;
        dropoff_datetime — дата и время, когда счётчик был отключён.

    Географическая информация:
        pickup_longitude — долгота, на которой был включён счётчик;
        pickup_latitude — широта, на которой был включён счётчик;
        dropoff_longitude — долгота, на которой счётчик был отключён;
        dropoff_latitude — широта, на которой счётчик был отключён.

    Прочие признаки:
        passenger_count — количество пассажиров в транспортном средстве (введённое водителем значение);
        store_and_fwd_flag — флаг, который указывает, сохранилась ли запись о поездке в памяти транспортного средства перед отправкой поставщику (Y — хранить и пересылать, N — не хранить и не пересылать поездку).

    Целевой признак:
        trip_duration — продолжительность поездки в секундах.


holiday_data.csv датасет содержит информацию о том, является ли день праздничным, собраны даты всех праздничных дней в Америке за 2016 год. Данные представлены в табличном формате CSV и содержат три столбца:
        day — день недели;
        date — дата;
        holiday — наименование праздника.


osrm_data_train.csv датасет содержит данные из OSRM (Open Source Routing Machine) для поездок к таблице с тренировочными данными. Интересуют только следующие столбцы:
        id — идентификатор поездки;
        total_distance — кратчайшее дорожное расстояние (в метрах) из точки, в которой был включён счётчик, до точки, в которой счётчик был выключен (согласно OSRM);
        total_travel_time — наименьшее время поездки (в секундах) из точки, в которой был включён счётчик, до точки, в которой счётчик был выключен (согласно OSRM);
        number_of_steps — количество дискретных шагов, которые должен выполнить водитель (поворот налево/поворот направо/ехать прямо и т.д.).


weather_data.csv датасет содержит данные информацию о погодных условиях в Нью-Йорке в 2016 году. Интересуют только следующие столбцы:
        time — дата измерения (с интервалом в час);
        temperature — температура;
        visibility — видимость;
        wind speed — средняя скорость ветра;
        precip — количество осадков;
        events — погодные явления: Rain — дождь, Snow — снег, Fog — туман, None — отсутствие погодных явлений.


:arrow_up:[to Table of Contents](README.md#оглавление)


### Этапы Работы над Проектом

1. Описательный Анализ Данных:
   - знакомство с данными

2. Обработка Данных:
   - работа с пропусками и выбросами в данных
   - удаление признаков

3. Преобразование Данных:
   - работа с пропусками
   - создание признаков
   - кодировка признаков

4. Разведывательный Анализ Данных:
   - Проверка на Мультиколлинеарность:
      - Pearson's Correlation для числовых признаков
   - Визуализация Данных:
      - исследовать данные
      - нащупать первые закономерности и выдвинуть гипотезы

5. Очистка и Отбор Признаков:
   - преобразование и удаление признаков
   - отбор признаков на основании мультиколлинеарности и с помощью метода SelectKBest

6. Построение Моделей:
   - разделение данных для модели: выделение обучаемой и тестовой частей
   - подбор метрик для оченки качества

7. Обучение Моделей для Решения Задачи Классификации:
   - линейная регрессия
   - деревья решений
   - случайный лес
   - gradient boosting
   - xgboost

:arrow_up:[to Table of Contents](README.md#оглавление)


### Результат

В результате лучшие результаты показали модели:

    - Gradient Boosting: RMSLE = 0.393
    - XGBoost: RMSLE = 0.394


:arrow_up:[to Table of Contents](README.md#оглавление)
